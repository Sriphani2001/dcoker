<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Meurs</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; }
    .card { border: 1px solid #ddd; border-radius: 10px; padding: 20px; }
    .row { margin: 10px 0; }
    input { padding: 8px; width: 100%; box-sizing: border-box; }
    button { padding: 10px 16px; cursor: pointer; }
    .tabs button { margin-right: 8px; }
    .hidden { display: none; }
    .icons { display: flex; gap: 24px; margin-top: 16px; }
    .icon { text-align: center; cursor: pointer; }
    audio, video { width: 100%; max-width: 480px; }
  </style>
</head>
<body>

  <h1>Welcome to Meurs</h1>

  <!-- AUTH CARD -->
  <div id="auth-card" class="card">
    <div class="tabs">
      <button id="tab-login">Login</button>
      <button id="tab-signup">Sign up</button>
    </div>

    <div id="login-form">
      <div class="row"><input id="login-username" placeholder="Username" /></div>
      <div class="row"><input id="login-password" type="password" placeholder="Password" /></div>
      <button id="login-btn">Login</button>
    </div>

    <div id="signup-form" class="hidden">
      <div class="row"><input id="signup-username" placeholder="Username" /></div>
      <div class="row"><input id="signup-password" type="password" placeholder="Password" /></div>
      <button id="signup-btn">Create account</button>
    </div>

    <div id="auth-msg" class="row"></div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" class="hidden">
    <h2>Dashboard</h2>
    <div class="icons">
      <div class="icon" id="open-music">
        ðŸŽµ
        <div>Music</div>
      </div>
      <div class="icon" id="open-videos">
        ðŸŽ¬
        <div>Videos</div>
      </div>
    </div>
    <div id="content-area" class="card" style="margin-top:16px;"></div>
  </div>

<script>
const API = "/api"; // same origin (FastAPI serves this HTML), so empty = current host

// tab switching
const loginForm = document.getElementById("login-form");
const signupForm = document.getElementById("signup-form");
document.getElementById("tab-login").onclick = () => { loginForm.classList.remove("hidden"); signupForm.classList.add("hidden"); };
document.getElementById("tab-signup").onclick = () => { signupForm.classList.remove("hidden"); loginForm.classList.add("hidden"); };

const msg = (t, ok=false) => {
  const el = document.getElementById("auth-msg");
  el.style.color = ok ? "green" : "crimson";
  el.textContent = t;
};

// SIGNUP
document.getElementById("signup-btn").onclick = async () => {
  const username = document.getElementById("signup-username").value.trim();
  const password = document.getElementById("signup-password").value;
  if (!username || !password) return msg("Enter username and password");
  try {
    const res = await fetch(`${API}/signup`, {
      method: "POST", headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password })
    });
    const data = await res.json();
    if (!res.ok) throw new Error(data.detail || "Sign up failed");
    msg("Account created. You can log in now.", true);
    // switch to login tab
    document.getElementById("tab-login").click();
  } catch (e) {
    msg(e.message);
  }
};

// LOGIN
document.getElementById("login-btn").onclick = async () => {
  const username = document.getElementById("login-username").value.trim();
  const password = document.getElementById("login-password").value;
  if (!username || !password) return msg("Enter username and password");
  try {
    const res = await fetch(`${API}/login`, {
      method: "POST", headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password })
    });
    const data = await res.json();
    if (!res.ok) throw new Error(data.detail || "Login failed");
    // hide auth, show dashboard
    document.getElementById("auth-card").classList.add("hidden");
    document.getElementById("dashboard").classList.remove("hidden");
    msg("");
  } catch (e) {
    msg(e.message);
  }
};

// DASHBOARD actions
document.getElementById("open-music").onclick = async () => {
  const box = document.getElementById("content-area");
  box.innerHTML = "<h3>Music</h3>";
  const res = await fetch(`${API}/music`);
  const data = await res.json();
  if (!Array.isArray(data.music)) { box.textContent = "No music found"; return; }
  data.music.forEach(file => {
    const p = document.createElement("p"); p.textContent = file; box.appendChild(p);
    const audio = document.createElement("audio"); audio.controls = true; audio.src = `${API}/static/music/${file}`; box.appendChild(audio);
  });
};

document.getElementById("open-videos").onclick = async () => {
  const box = document.getElementById("content-area");
  box.innerHTML = "<h3>Videos</h3>";
  const res = await fetch(`${API}/videos`);
  const data = await res.json();
  if (!Array.isArray(data.videos)) { box.textContent = "No videos found"; return; }
  data.videos.forEach(file => {
    const p = document.createElement("p"); p.textContent = file; box.appendChild(p);
    const vid = document.createElement("video"); vid.controls = true; vid.src = `${API}/static/videos/${file}`; box.appendChild(vid);
  });
};
</script>
</body>
</html>
<!-- hsbfqs -->
